<html>
<head>
    <link href="css/bootstrap.min.css" rel="stylesheet"/>
    <link href="css/bootstrap-theme.min.css" rel="stylesheet"/>

    <script src="js/jquery-3.1.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/angular/angular.min.js"></script>
    <script src="js/angular/angular-messages.min.js"></script>
    <script src="../src/ng-data-annotations.min.js"></script>
</head>

<body ng-app="MainModule"
      ng-controller="MainController"
      ng-init="init()">

	  <div></div>
<div class="panel panel-primary">
    <div class="panel-heading">
        <span>Accounts list</span>
    </div>
    <form name="accountsListForm"
          class="panel-body">
        <table class="table table-responsive table-striped table-condensed">
            <thead>
            <tr>
                <th>Full name</th>
                <th>Name</th>
                <th>Nick</th>
                <th>In</th>
                <th>Out</th>
                <th>Age</th>
                <th>Father age</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="account in accounts track by $index">

                <!-- Full name -->
                <td>
                    <input name="accountFullName_{{$index}}"
                           class="form-control"
                           ng-model="account.fullName"
                           required="required"
                           text-property-contains="account.name"
                           text-property-contains-case-insensitive="false"
                           text-property-contains-result="-1"
                           text-property-contains-operator="!="/>

                    <ul class="validation-summary-error"
                        ng-messages="accountsListForm['accountFullName_' + $index].$error">
                        <li ng-message="textPropertyContains">Text should contains {{account.name}}</li>
                    </ul>
                </td>

                <!-- Name -->
                <td>
                    <input name="accountName_{{$index}}"
                           class="form-control"
                           ng-model="account.name"
                           required="required"/>

                    <ul class="validation-summary-error"
                        ng-messages="accountsListForm['accountName_' + $index].$error">
                        <li ng-message="required">This field is required</li>
                    </ul>
                </td>

                <!-- Nick name -->
                <td>
                    <input name="accountNick_{{$index}}"
                           class="form-control"
                           ng-model="account.nick"
                           required="required"
                           text-property-compares="account.name"
                           text-property-compares-operator="="/>

                    <ul class="validation-summary-error"
                        ng-messages="accountsListForm['accountNick_' + $index].$error">
                        <li ng-message="textPropertyCompares">Nick must be the same as name</li>
                    </ul>
                </td>

                <!-- Account in -->
                <td>
                    <input name="accountIn_{{$index}}"
                           class="form-control"
                           ng-model="account.in"
                           type="date"
                           required="required"

                           time-property-compares="account.out"
                           time-property-compares-operator=">"/>

                    <ul class="validation-summary-error"
                        ng-messages="accountsListForm['accountIn_' + $index].$error">
                        <li ng-message="timePropertyCompares">This comparision</li>
                    </ul>
                </td>

                <!-- Account out -->
                <td>
                    <input class="form-control"
                           ng-model="account.out"
                           type="date"/>
                </td>

                <!-- Account age -->
                <td>
                    <input name="accountAge_{{$index}}"
                            class="form-control"
                           type="number"
                           step="1"
                           min="10"
                           max="100"
                           ng-model="account.age"

                           numeric-property-compares="account.fatherAge"
                           numeric-property-compares-operator="<"
                           numeric-property-compares-mathematic-operator="-"
                           numeric-property-compares-mathematic-range="40" />

                    <ul class="validation-summary-error"
                        ng-messages="accountsListForm['accountAge_' + $index].$error">
                        <li ng-message="numericPropertyCompares">This comparision</li>
                    </ul>

                </td>

                <!-- Account father age -->
                <td>
                    <input name="fatherAge_{{$index}}"
                           class="form-control" type="number"
                           step="1"
                           min="10"
                           max="100"
                           ng-model="account.fatherAge"
                           ng-function-validate="is-adult;is-even;in-out-same"
                           ng-function-validate-monitors="account.fullName;account.name"
                           ng-function-validate-is-adult="isAdult(account.fatherAge)"
                           ng-function-validate-is-even="isEven(account.fatherAge)"
                           ng-function-validate-in-out-same="account.fullName == account.name"/>

                    <ul class="validation-summary-error"
                        ng-messages="accountsListForm['fatherAge_' + $index].$error">
                        <li ng-message="ng-function-validate-is-adult">Is not adult</li>
                        <li ng-message="ng-function-validate-is-even">Age must be an even number</li>
                        <li ng-message="ng-function-validate-in-out-same">In out must be the same as each other.</li>
                    </ul>
                </td>
            </tr>
            </tbody>
        </table>
    </form>
</div>


</body>
</html>

<script>

    // Initiate angular application.
    var app = angular.module("MainModule", ['ngMessages', 'ngDataAnnotations']);

    // Initiate controller.
    app.controller("MainController", function ($scope) {

        $scope.accounts = [];

        // Initiate data.
        $scope.init = function () {

            // Find the current date.
            var date = new Date();

            // Find current day.
            var day = date.getDate();

            for (var index = 0; index < 10; index++) {

                // Increase day by one.
                day++;

                // Increase date.
                date.setDate(day);

                $scope.accounts.push({
                    fullName: 'fullName',
                    name: 'name_' + index,
                    nick: 'name',
                    in: date,
                    out: date,
                    age: 10,
                    fatherAge: 50
                });


                // Base on age to check whether that person is adult or not.
                $scope.isAdult = function(age){
                    return age >= 18;
                }

                // Check whether number is even or not.
                $scope.isEven = function(age){
                    return age % 2 === 0;
                }
            }
        }
    });


</script>